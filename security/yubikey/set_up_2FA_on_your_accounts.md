# Set up 2FA on your accounts

You can use your YubiKey to generate TOTP values for OATH-supported applications.

You can set up 2FA with your YubiKey on Github instead of using Google Authenticator. When you log in Github, then you get asked an additional 6-digit code, which will be generated by your YubiKey.

## Add an account

The `ykman` utility can add a 2FA authentication to your YubiKey and generate a TOPT (time-based one-time password) based on a secret token.

The `ykman` utility needs the secret token given by the OATH application to generate a TOTP value. You'll usually need to use an authenticator to set up 2FA for an OATH application. Google Authenticator, Authy, and `Yubico Authenticator` store the secret token for you by scanning the QR code given by the OATH application. The `ykman` utility can only store a token on your YubiKey by adding it in its plain-text form. Most OATH applications have the option below the QR code to copy the token as plain text.

```Bash
% Add a credential for an OATH application.
$ ykman oath accounts add --touch {SERVICE} {SECRET_TOKEN}

% Generate a TOTP value for that credential.
$ ykman oath accounts code {SERVICE}

% This is an example of its usage:
$ ykman oath accounts add --touch Github f5up4ub3dw
$ ykman oath accounts code github
Touch your YubiKey...
Github 125623
```

The `--touch` option lets the YubiKey know that it requires a touch before it will generate a TOTP value for that credential. When the YubiKey is plugged in your machine, then that option prevents malware from generating a code.

**CAUTION**: Remove the secret token from your command history!

**CAUTION**: If you have only one YubiKey, and you lose it, then it will be as bad as losing your phone with everything on Google Authenticator. Store the recovery codes in a safe place. Preferably encrypted, and not on your machine or in your password manager.

## Protect your accounts

### Set a password

You can set a password to protect your OATH accounts. If you don't set an OATH password on your YubiKey, then anyone can plug it in one's machine and use your credentials.

```Bash
$ ykman oath access change

% This is an example of its usage:
$ ykman oath access change
Enter the new password: { ... }
Repeat for confirmation: { ... }
Password updated.
```

You'll get asked for your password each time you generate a TOTP value. This can be avoided by storing the password on your device.

```Bash
$ ykman oath access remember

% This is an example of its usage:
$ ykman oath access remember
Enter the password: { ... }
Password remembered.
```

**CAUTION**: Forgetting your password is like losing your YubiKey. If you do then you'll have to reset every 2FA credential. If your devices remember the password, don't forget to also remember the password yourself. If you don't use it regularly, then store your password in a safe place. Preferably together with your recovery codes. Since the password gives the same level of access to your accounts.

### Backup your credentials

A common precaution is to have a second YubiKey in case of the first one is lost, stolen or broken. You'll have to keep both keys in sync with one another. With 2FA credentials, you'll have to add the same token in the same way on the second key. The firmware doesn't allow for secrets to be read once on the key, so it's best to add it to both immediately.

### Check if all credentials require a touch

You can quickly see if each credential requires a touch to generate a TOTP. Sometimes I forget to add a credential with the `--touch` option, which means it can't be altered, and I'll have to replace it in its entirely.

```Bash
$ ykman oath accounts code

% This is an example of its usage:
$ ykman oath accounts code
Github     [Requires Touch]
LinkedIn   125623
Paypal     [Requires Touch]
```

**source**: [YubiKey Manager CLI (ykman) User Manual](https://support.yubico.com/hc/en-us/articles/360016614940-YubiKey-Manager-CLI-ykman-User-Manual)
**source**: [Using Your Yubikey with Authenticator Codes](https://support.yubico.com/hc/en-us/articles/360013789259-Using-Your-YubiKey-with-Authenticator-Codes)
**source**: [Can I Duplicate or Back Up a YubiKey?](https://support.yubico.com/hc/en-us/articles/360016614880-Can-I-Duplicate-or-Back-Up-a-YubiKey)
